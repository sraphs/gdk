<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=generator content="Hugo 0.101.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>Publish Messages to a Topic &#183; Go Development Kit</title><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Source+Code+Pro|Work+Sans:400,700"><link type=text/css rel=stylesheet href=../../../css/syntax.css><link type=text/css rel=stylesheet href=../../../css/style.css><link rel="shortcut icon" href=../../../favicon-32x32.png></head><body><div class=PageLayout><header class=PageHeader><a href><h1 class=PageLogo><img class=PageLogo-image src=../../../go-cdk-logo-white.png alt="Go Development Kit"></h1></a></header><main class=MainContent><div class=MainContent-bounds><h1>Publish Messages to a Topic</h1><nav class=PageTOC><div class=PageTOC-heading>In this article</div><nav id=TableOfContents><ul><li><a href=#opening>Opening a Topic</a></li><li><a href=#sending>Sending Messages on a Topic</a></li><li><a href=#other-usage-samples>Other Usage Samples</a></li><li><a href=#services>Supported Pub/Sub Services</a><ul><li><a href=#rabbitmq>RabbitMQ</a></li><li><a href=#nats>NATS</a></li><li><a href=#kafka>Kafka</a></li><li><a href=#mem>In-Memory</a></li></ul></li></ul></nav></nav><p>Publishing a message to a topic with the GDK takes two steps:</p><ol><li><a href=#opening>Open a topic</a> with the Pub/Sub provider of your choice (once per topic).</li><li><a href=#sending>Send messages</a> on the topic.</li></ol><h2 id=opening>Opening a Topic<a class=anchor href=#opening aria-label="Link to Section">ðŸ”—</a></h2><p>The first step in publishing messages to a topic is to instantiate a
portable <a href=https://godoc.org/github.com/sraphs/gdk/pubsub#Topic><code>*pubsub.Topic</code></a> for your service.</p><p>The easiest way to do so is to use <a href=https://godoc.org/github.com/sraphs/gdk/pubsub#OpenTopic><code>pubsub.OpenTopic</code></a> and a service-specific URL
pointing to the topic, making sure you <a href=https://golang.org/doc/effective_go.html#blank_import>&ldquo;blank import&rdquo;</a> the driver package to
link it in.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;github.com/sraphs/gdk/pubsub&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nx>_</span> <span class=s>&#34;github.com/sraphs/gdk/pubsub/&lt;driver&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=nx>ctx</span> <span class=o>:=</span> <span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nx>topic</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>pubsub</span><span class=p>.</span><span class=nf>OpenTopic</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span> <span class=s>&#34;&lt;driver-url&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;could not open topic: %v&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Shutdown</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>// topic is a *pubsub.Topic; see usage below
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>...</span>
</span></span></code></pre></div><p>See <a href=../../../concepts/urls/>Concepts: URLs</a> for general background and the <a href=#services>guide below</a>
for URL usage for each supported service.</p><p>Alternatively, if you need fine-grained
control over the connection settings, you can call the constructor function in
the driver package directly (like <code>gcppubsub.OpenTopic</code>).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;github.com/sraphs/gdk/pubsub/&lt;driver&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=nx>topic</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=p>&lt;</span><span class=nx>driver</span><span class=p>&gt;.</span><span class=nf>OpenTopic</span><span class=p>(</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><p>You may find the <a href=http://github.com/google/wire><code>wire</code> package</a> useful for managing your initialization code
when switching between different backing services.</p><p>See the <a href=#services>guide below</a> for constructor usage for each supported service.</p><h2 id=sending>Sending Messages on a Topic<a class=anchor href=#sending aria-label="Link to Section">ðŸ”—</a></h2><p>Sending a message on a <a href=https://godoc.org/github.com/sraphs/gdk/pubsub#Topic>Topic</a> looks
like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>err</span> <span class=o>:=</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Send</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>pubsub</span><span class=p>.</span><span class=nx>Message</span><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Body</span><span class=p>:</span> <span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;Hello, World!\n&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>	<span class=c1>// Metadata is optional and can be nil.
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Metadata</span><span class=p>:</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>// These are examples of metadata.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// There is nothing special about the key names.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=s>&#34;language&#34;</span><span class=p>:</span>   <span class=s>&#34;en&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s>&#34;importance&#34;</span><span class=p>:</span> <span class=s>&#34;high&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Note that the <a href=https://godoc.org/github.com/sraphs/gdk/pubsub#hdr-At_most_once_and_At_least_once_Delivery>semantics of message delivery</a> can vary by backing service.</p><h2 id=other-usage-samples>Other Usage Samples<a class=anchor href=#other-usage-samples aria-label="Link to Section">ðŸ”—</a></h2><ul><li><a href=https://github.com/sraphs/gdk/tree/master/samples/gocdk-pubsub>CLI Sample</a></li><li><a href=https://github.com/sraphs/gdk/tutorials/order/>Order Processor sample</a></li><li><a href=https://godoc.org/github.com/sraphs/gdk/pubsub#pkg-examples>pubsub package examples</a></li></ul><h2 id=services>Supported Pub/Sub Services<a class=anchor href=#services aria-label="Link to Section">ðŸ”—</a></h2><h3 id=rabbitmq>RabbitMQ<a class=anchor href=#rabbitmq aria-label="Link to Section">ðŸ”—</a></h3><p>The GDK can publish to an <a href=https://www.rabbitmq.com/protocol.html>AMQP 0.9.1</a> fanout exchange, the dialect of
AMQP spoken by <a href=https://www.rabbitmq.com>RabbitMQ</a>. A RabbitMQ URL only includes the exchange name.
The RabbitMQ&rsquo;s server is discovered from the <code>RABBIT_SERVER_URL</code> environment
variable (which is something like <code>amqp://guest:guest@localhost:5672/</code>).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/sraphs/gdk/pubsub&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nx>_</span> <span class=s>&#34;github.com/sraphs/gdk/pubsub/rabbitpubsub&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// pubsub.OpenTopic creates a *pubsub.Topic from a URL.
</span></span></span><span class=line><span class=cl><span class=c1>// This URL will Dial the RabbitMQ server at the URL in the environment
</span></span></span><span class=line><span class=cl><span class=c1>// variable RABBIT_SERVER_URL and open the exchange &#34;myexchange&#34;.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>topic</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>pubsub</span><span class=p>.</span><span class=nf>OpenTopic</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span> <span class=s>&#34;rabbit://myexchange&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Shutdown</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=rabbitmq-ctor>RabbitMQ Constructor<a class=anchor href=#rabbitmq-ctor aria-label="Link to Section">ðŸ”—</a></h4><p>The <a href=https://godoc.org/github.com/sraphs/gdk/pubsub/rabbitpubsub#OpenTopic><code>rabbitpubsub.OpenTopic</code></a> constructor opens a RabbitMQ exchange. You
must first create an <a href=https://pkg.go.dev/github.com/rabbitmq/amqp091-go#Connection><code>*amqp.Connection</code></a> to your RabbitMQ instance.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>amqp</span> <span class=s>&#34;github.com/rabbitmq/amqp091-go&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/sraphs/gdk/pubsub/rabbitpubsub&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>rabbitConn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>amqp</span><span class=p>.</span><span class=nf>Dial</span><span class=p>(</span><span class=s>&#34;amqp://guest:guest@localhost:5672/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>rabbitConn</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nx>topic</span> <span class=o>:=</span> <span class=nx>rabbitpubsub</span><span class=p>.</span><span class=nf>OpenTopic</span><span class=p>(</span><span class=nx>rabbitConn</span><span class=p>,</span> <span class=s>&#34;myexchange&#34;</span><span class=p>,</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Shutdown</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=nats>NATS<a class=anchor href=#nats aria-label="Link to Section">ðŸ”—</a></h3><p>The GDK can publish to a <a href=https://nats.io/>NATS</a> subject. A NATS URL only includes the
subject name. The NATS server is discovered from the <code>NATS_SERVER_URL</code>
environment variable (which is something like <code>nats://nats.example.com</code>).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/sraphs/gdk/pubsub&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nx>_</span> <span class=s>&#34;github.com/sraphs/gdk/pubsub/natspubsub&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// pubsub.OpenTopic creates a *pubsub.Topic from a URL.
</span></span></span><span class=line><span class=cl><span class=c1>// This URL will Dial the NATS server at the URL in the environment variable
</span></span></span><span class=line><span class=cl><span class=c1>// NATS_SERVER_URL and send messages with subject &#34;example.mysubject&#34;.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>topic</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>pubsub</span><span class=p>.</span><span class=nf>OpenTopic</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span> <span class=s>&#34;nats://example.mysubject&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Shutdown</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><p>Because NATS does not natively support metadata, messages sent to NATS will
be encoded with <a href=https://golang.org/pkg/encoding/gob/>gob</a>.</p><h4 id=nats-ctor>NATS Constructor<a class=anchor href=#nats-ctor aria-label="Link to Section">ðŸ”—</a></h4><p>The <a href=https://godoc.org/github.com/sraphs/gdk/pubsub/natspubsub#OpenTopic><code>natspubsub.OpenTopic</code></a> constructor opens a NATS subject as a topic. You
must first create an <a href=https://godoc.org/github.com/nats-io/go-nats#Conn><code>*nats.Conn</code></a> to your NATS instance.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/nats-io/nats.go&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/sraphs/gdk/pubsub/natspubsub&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>natsConn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>nats</span><span class=p>.</span><span class=nf>Connect</span><span class=p>(</span><span class=s>&#34;nats://nats.example.com&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>natsConn</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>topic</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>natspubsub</span><span class=p>.</span><span class=nf>OpenTopic</span><span class=p>(</span><span class=nx>natsConn</span><span class=p>,</span> <span class=s>&#34;example.mysubject&#34;</span><span class=p>,</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Shutdown</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=kafka>Kafka<a class=anchor href=#kafka aria-label="Link to Section">ðŸ”—</a></h3><p>The GDK can publish to a <a href=https://kafka.apache.org/>Kafka</a> cluster. A Kafka URL only includes the
topic name. The brokers in the Kafka cluster are discovered from the
<code>KAFKA_BROKERS</code> environment variable (which is a comma-delimited list of
hosts, something like <code>1.2.3.4:9092,5.6.7.8:9092</code>).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/sraphs/gdk/pubsub&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nx>_</span> <span class=s>&#34;github.com/sraphs/gdk/pubsub/kafkapubsub&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// pubsub.OpenTopic creates a *pubsub.Topic from a URL.
</span></span></span><span class=line><span class=cl><span class=c1>// The host + path are the topic name to send to.
</span></span></span><span class=line><span class=cl><span class=c1>// The set of brokers must be in an environment variable KAFKA_BROKERS.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>topic</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>pubsub</span><span class=p>.</span><span class=nf>OpenTopic</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span> <span class=s>&#34;kafka://my-topic&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Shutdown</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=kafka-ctor>Kafka Constructor<a class=anchor href=#kafka-ctor aria-label="Link to Section">ðŸ”—</a></h4><p>The <a href=https://godoc.org/github.com/sraphs/gdk/pubsub/kafkapubsub#OpenTopic><code>kafkapubsub.OpenTopic</code></a> constructor opens a Kafka topic to publish
messages to. Depending on your Kafka cluster configuration (see
<code>auto.create.topics.enable</code>), you may need to provision the topic beforehand.</p><p>In addition to the list of brokers, you&rsquo;ll need a <a href=https://godoc.org/github.com/Shopify/sarama#Config><code>*sarama.Config</code></a>, which
exposes many knobs that can affect performance and semantics; review and set
them carefully. <a href=https://godoc.org/github.com/sraphs/gdk/pubsub/kafkapubsub#MinimalConfig><code>kafkapubsub.MinimalConfig</code></a> provides a minimal config to get
you started.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/sraphs/gdk/pubsub/kafkapubsub&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// The set of brokers in the Kafka cluster.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>addrs</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;1.2.3.4:9092&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// The Kafka client configuration to use.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>config</span> <span class=o>:=</span> <span class=nx>kafkapubsub</span><span class=p>.</span><span class=nf>MinimalConfig</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Construct a *pubsub.Topic.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>topic</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>kafkapubsub</span><span class=p>.</span><span class=nf>OpenTopic</span><span class=p>(</span><span class=nx>addrs</span><span class=p>,</span> <span class=nx>config</span><span class=p>,</span> <span class=s>&#34;my-topic&#34;</span><span class=p>,</span> <span class=kc>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Shutdown</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=mem>In-Memory<a class=anchor href=#mem aria-label="Link to Section">ðŸ”—</a></h3><p>The GDK includes an in-memory Pub/Sub provider useful for local testing.
The names in <code>mem://</code> URLs are a process-wide namespace, so subscriptions to
the same name will receive messages posted to that topic. This is detailed
more in the <a href=../../../howto/pubsub/subscribe/#mem>subscription guide</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/sraphs/gdk/pubsub&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nx>_</span> <span class=s>&#34;github.com/sraphs/gdk/pubsub/mempubsub&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>topic</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>pubsub</span><span class=p>.</span><span class=nf>OpenTopic</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span> <span class=s>&#34;mem://topicA&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Shutdown</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=mem-ctor>In-Memory Constructor<a class=anchor href=#mem-ctor aria-label="Link to Section">ðŸ”—</a></h4><p>To create an in-memory Pub/Sub topic, use the <a href=https://godoc.org/github.com/sraphs/gdk/pubsub/mempubsub#NewTopic><code>mempubsub.NewTopic</code>
function</a>. You can use the returned topic to create in-memory
subscriptions, as detailed in the <a href=../../../howto/pubsub/subscribe/#mem-ctor>subscription guide</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/sraphs/gdk/pubsub/mempubsub&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>topic</span> <span class=o>:=</span> <span class=nx>mempubsub</span><span class=p>.</span><span class=nf>NewTopic</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>topic</span><span class=p>.</span><span class=nf>Shutdown</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
</span></span></code></pre></div></div></main><nav class=Sidenav><ul class=Sidenav-list><li class=Sidenav-section><a href=../../../ class=Sidenav-sectionLink>Home</a></li><li class=Sidenav-section><a href=../../../howto/ class=Sidenav-sectionLink>How-To Guides</a><ul class=Sidenav-pageList><li class=Sidenav-page><a href=../../../howto/blob/ class=Sidenav-pageLink>Blob</a></li><li class=Sidenav-page><a href=../../../howto/pubsub/ class=Sidenav-pageLink>Pub/Sub</a></li><li class=Sidenav-page><a href=../../../howto/runtimevar/ class=Sidenav-pageLink>Runtime Configuration</a></li><li class=Sidenav-page><a href=../../../howto/secrets/ class=Sidenav-pageLink>Secrets</a></li></ul></li><li class=Sidenav-section><a href=../../../concepts/ class=Sidenav-sectionLink>Concepts</a><ul class=Sidenav-pageList><li class=Sidenav-page><a href=../../../concepts/structure/ class=Sidenav-pageLink>Structuring Portable Code</a></li><li class=Sidenav-page><a href=../../../concepts/urls/ class=Sidenav-pageLink>URLs</a></li><li class=Sidenav-page><a href=../../../concepts/as/ class=Sidenav-pageLink>Using provider-specific APIs</a></li></ul></li></ul></nav><footer class=PageFooter><nav><ul class=FooterLinks><li class=FooterLinks-item><a href=https://github.com/sraphs/gdk/ class=FooterLinks-link>GitHub</a></li><li class=FooterLinks-item><a href=https://github.com/sraphs/gdk/issues class=FooterLinks-link>Contact Team</a></li></ul></nav><p class=PageFooter-paragraph>Copyright Â© 2022-2022 The Go Development Kit Authors.</p><p class=PageFooter-paragraph>All content released under an <a href=https://github.com/sraphs/gdk/blob/main/LICENSE target=_blank class=PageFooter-link>MIT License</a>.</p></footer></div></body></html>